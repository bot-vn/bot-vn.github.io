<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Redirecting to TikTok LIVE...</title>
  <script>
    function getParam(name) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(name);
    }

    // Giải mã base64 username từ URL
    const encoded = window.location.search.slice(1);
    const username = atob(encoded);

    // Gọi API để lấy roomId theo username
    fetch(`https://tiktok.eulerstream.com/webcast/room_info?uniqueId=${username}`, {
      headers: { 'x-api-key': 'YzU5NmUzYWZkYjViZGE1ZjU1ZWZjZmQ0ZTQyOGY0NzI3NjgxMDM3Mjk4ZmJiNDU4NGUzZjQ4' }
    })
      .then(res => res.json())
      .then(data => {
        if (data?.data?.room_info?.id) {
          const roomId = data.data.room_info.id;
          location.href = `https://www.tiktok.com/live/room/${roomId}`;
        } else {
          document.body.innerHTML = '<h2>Không tìm thấy livestream</h2>';
        }
      })
      .catch(err => {
        document.body.innerHTML = '<h2>Lỗi kết nối: ' + err.message + '</h2>';
      });
  </script>
</head>
<body>
  <p>Đang chuyển hướng đến TikTok LIVE...</p>
</body>
</html>
