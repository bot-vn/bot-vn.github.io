<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Redirecting to TikTok</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noindex,nofollow">
  <script>
    // Bảng mã base62
    const BASE62 = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";

    function decodeBase62(str) {
      let num = 0n;
      for (let char of str) {
        const value = BASE62.indexOf(char);
        if (value === -1) return null;
        num = num * 62n + BigInt(value);
      }
      return num.toString();
    }

    function getParam() {
      const query = window.location.search.slice(1); // bỏ dấu '?'
      return query || null;
    }

    window.onload = function () {
      const encoded = getParam();
      if (!encoded) {
        document.body.innerText = "❌ Thiếu mã roomId!";
        return;
      }

      const decodedRoomId = decodeBase62(encoded);
      if (!decodedRoomId) {
        document.body.innerText = "❌ Mã không hợp lệ!";
        return;
      }

      const deepLink = `snssdk1180://live/room/${decodedRoomId}`;
      window.location.href = deepLink;

      // Dự phòng nếu redirect không hoạt động
      setTimeout(() => {
        document.body.innerHTML = `
          <h2>Đang mở TikTok Live...</h2>
          <p>Nếu không được tự động chuyển, hãy bấm vào đây:</p>
          <a href="${deepLink}">${deepLink}</a>
        `;
      }, 1000);
    };
  </script>
</head>
<body>
  <h2>Đang chuyển hướng...</h2>
</body>
</html>
