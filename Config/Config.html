async function saveConfig() {
  const owner = 'bot-vn';
  const repo = 'bot-vn.github.io';
  const path = 'Config/1Config.json';
  const token = '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';

  // Lấy SHA hiện tại của file
  const getRes = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${path}`, {
    headers: {
      'Authorization': `Bearer ${token}`,
      'Accept': 'application/vnd.github+json'
    }
  });
  if (!getRes.ok) {
    alert('Không lấy được SHA file trên GitHub!');
    return;
  }
  const fileData = await getRes.json();
  const sha = fileData.sha;

  // Tạo object config mới từ form
  const newConfig = {
    preferredAgents: ["rn-sjc-2-a", "rn-sjc-2-b", "rn-chi-1-a"],
    telegram: {
      proxyTimeout: 5000,
      preferredRegions: [],
      targetCountries: [],
      maxRetries: 2,
      SmallBox: {
        minTime: Number(document.getElementById('smallBoxThreshold').value),
        minCoins: Number(document.getElementById('minBox').value),
        minRate: Number(document.getElementById('minRate').value)
      },
      BigBox: {
        minTime: Number(document.getElementById('potentialTime').value),
        minCoins: Number(document.getElementById('potentialCoins').value),
        minRate: Number(document.getElementById('potentialRate').value)
      },
      shortBoxThreshold: 30,
      enableLiveNoBox: false,
      idolIds: document.getElementById('idolIds').value.split(',').map(x => x.trim()).filter(Boolean)
    },
    websocket: {
      maxConnections: 1000,
      blacklistDuration: 1800
    },
    api: {
      requestDelay: 300
    },
    file: {
      state: "./Data/ResumeData.json"
    },
    google: {
      scopes: ["https://www.googleapis.com/auth/spreadsheets"]
    },
    scan: {},
    flags: {
      enableTelegram: true
    },
    apiQuotaLimit: 2000
  };

  // Gửi PUT để cập nhật file
  const res = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${path}`, {
    method: 'PUT',
    headers: {
      'Authorization': `Bearer ${token}`,
      'Accept': 'application/vnd.github+json',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      message: 'Update 1Config.json from web UI',
      content: btoa(unescape(encodeURIComponent(JSON.stringify(newConfig, null, 2)))),
      sha: sha
    })
  });

  const messageElement = document.getElementById('message');
  if (res.ok) {
    messageElement.textContent = '✅ Lưu thành công lên GitHub!';
    messageElement.style.color = '#28a745';
  } else {
    messageElement.textContent = '❌ Lỗi: Không thể gửi đến GitHub';
    messageElement.style.color = '#d9534f';
  }
}
